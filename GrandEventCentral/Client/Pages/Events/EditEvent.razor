@page "/events/edit"
@inject HttpClient Http
@attribute [Authorize]
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
<h3>Edit Event</h3>

@if (myPublicEvent != null)
{
<EventFormPage Event="myPublicEvent" OnValidSubmit="SaveEvent"></EventFormPage>}


@code { 
    private PublicEvent myPublicEvent = new PublicEvent();

    private async Task SaveEvent()
    {
        var body = Newtonsoft.Json.JsonConvert.SerializeObject(myPublicEvent);

        try
        {
            var eventId = await Http.PostAsync("Api/Events", new StringContent(body, System.Text.Encoding.UTF8, "application/json"));
        }
        catch (AccessTokenNotAvailableException exception)
        {
            exception.Redirect();
        }
    }
}
